

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Les membres &mdash; Zeste de Savoir 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Zeste de Savoir 1.0 documentation" href="../index.html"/>
        <link rel="up" title="Le back-end" href="../back-end.html"/>
        <link rel="next" title="Les messages privés" href="private-message.html"/>
        <link rel="prev" title="Les galeries" href="gallery.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Zeste de Savoir
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflow.html"><em>Workflow</em> et détails pratiques</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../back-end.html">Le <em>back-end</em></a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="contents.html">Les tutoriels et articles</a></li>
<li class="toctree-l2"><a class="reference internal" href="contents_manifest.html">Les fichiers de manifeste</a></li>
<li class="toctree-l2"><a class="reference internal" href="forum.html">Les forums</a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery.html">Les galeries</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Les membres</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inscription">Inscription</a></li>
<li class="toctree-l3"><a class="reference internal" href="#desinscription">Désinscription</a></li>
<li class="toctree-l3"><a class="reference internal" href="#les-membres-dans-les-environnement-de-test-et-de-developpement">Les membres dans les environnement de test et de développement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#l-interface-de-promotion">L’interface de promotion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#les-casquettes">Les casquettes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#l-interface-de-karma">L’interface de karma</a></li>
<li class="toctree-l4"><a class="reference internal" href="#l-interface-de-reinitialisation-de-mot-de-passe">L’interface de réinitialisation de mot de passe</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="private-message.html">Les messages privés</a></li>
<li class="toctree-l2"><a class="reference internal" href="searchv2.html">La recherche</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../back-end-code.html">Documentation technique du <em>back-end</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../front-end.html">Le <em>front-end</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils.html">Makefile et autres outils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Zeste de Savoir</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../back-end.html">Le <em>back-end</em></a> &raquo;</li>
        
      <li>Les membres</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/back-end/member.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="les-membres">
<h1>Les membres<a class="headerlink" href="#les-membres" title="Permalink to this headline">¶</a></h1>
<div class="section" id="inscription">
<h2>Inscription<a class="headerlink" href="#inscription" title="Permalink to this headline">¶</a></h2>
<p>L’inscription d’un membre se déroule en deux phases :</p>
<ul class="simple">
<li>Le membre crée son compte en fournissant un pseudo, un mot de passe et une adresse mail valide.</li>
<li>Un mail de confirmation est envoyé avec un jeton qui permettra d’activer le compte.</li>
</ul>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<ul class="last simple">
<li>Les virgules ne sont pas autorisées dans le pseudonyme, qui ne peut également pas commencer ou finir par des espaces.</li>
<li>Le mot de passe doit faire au moins 6 caractères.</li>
</ul>
</div>
</div>
<div class="section" id="desinscription">
<h2>Désinscription<a class="headerlink" href="#desinscription" title="Permalink to this headline">¶</a></h2>
<p>La désinscription se fait via l’interface utilisateur.</p>
<ul>
<li><p class="first">Le lien de désinscription est accessible via paramètres (<code class="docutils literal"><span class="pre">/membres/parametres/profil/</span></code>) puis “Se désinscrire” dans la barre
latérale (<code class="docutils literal"><span class="pre">/membres/desinscrire/avertissement/</span></code>) :</p>
<div class="figure align-center" id="id1">
<img alt="../_images/desinscription-1.png" src="../_images/desinscription-1.png" />
<p class="caption"><span class="caption-text">Position du lien de désinscription dans les paramètres du membre (<code class="docutils literal"><span class="pre">/membres/parametres/profil/</span></code>)</span></p>
</div>
</li>
<li><p class="first">Le lien mène alors vers une page expliquant les conséquences de sa désinscription. Il peut alors poursuivre via un bouton en bas de celle-ci :</p>
<div class="figure align-center" id="id2">
<img alt="../_images/desinscription-2.png" src="../_images/desinscription-2.png" />
<p class="caption"><span class="caption-text">Bouton de confirmation</span></p>
</div>
</li>
<li><p class="first">Le clic sur le bouton rouge ouvre une boite modale qui constitue le dernier avertissement avant le déclenchement du processus de désinscription :</p>
<div class="figure align-center" id="id3">
<img alt="../_images/desinscription-3.png" src="../_images/desinscription-3.png" />
<p class="caption"><span class="caption-text">La dernière étape</span></p>
</div>
</li>
</ul>
<p>Le clic sur “Me désinscrire” entraîne alors une série d’action (qui sont <strong>irréversibles</strong>) :</p>
<ul class="simple">
<li>Suppression du profil, libérant le pseudo et l’adresse courriel pour les futures inscriptions ;</li>
<li>Le membre est déconnecté ;</li>
<li>Les données du membre sont anonymisées :<ul>
<li><dl class="first docutils">
<dt>le pseudo <code class="docutils literal"><span class="pre">anonymous</span></code> est employé :</dt>
<dd><ul class="first last">
<li>pour les sujets du forum (qui, cependant, restent ouverts)</li>
<li>pour les messages des MP (le membre quitte les discussions auxquelles il participait) ;</li>
<li>pour les commentaires aux tutoriels et articles ;</li>
</ul>
</dd>
</dl>
</li>
<li>les <a class="reference external" href="../gallery/gallery.html">galeries</a> non liées à un tutoriel sont données à <code class="docutils literal"><span class="pre">external</span></code> (puisque l’image peut être considérée comme venant d’un “auteur”) avec droit de lecture et d’écriture ;</li>
<li>les <a class="reference external" href="../article/article.html">articles</a> et <a class="reference external" href="../tutorial/tutorial.html">tutoriels</a> suivent ces règles :<ul>
<li>si le tutoriel/article a été écrit par plusieurs personnes : le membre est retiré de la liste des auteurs ;</li>
<li>si le tutoriel/article est <em>publié</em>, il passe sur le compte “external”. Une demande expresse sera nécessaire au retrait complet de ces contenus ;</li>
<li>si le tutoriel/article n’est pas publié (brouillon, bêta, validation), il est supprimé, ainsi que la galerie qui lui est associée.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="les-membres-dans-les-environnement-de-test-et-de-developpement">
<h2>Les membres dans les environnement de test et de développement<a class="headerlink" href="#les-membres-dans-les-environnement-de-test-et-de-developpement" title="Permalink to this headline">¶</a></h2>
<p>Afin de faciliter les procédures de test en local, 8 utilisateurs ont été créés via la fixture <code class="docutils literal"><span class="pre">users.yaml</span></code> (utilisateur/mot de passe):</p>
<ul class="simple">
<li>user/user : utilisateur normal</li>
<li>staff/staff : utilisateur avec les droits d’un staff</li>
<li>admin/admin : utilisateur avec les droits d’un staff et d’un admin</li>
<li>anonymous/anonymous : utilisateur qui permet l’anonymisation des messages sur les forums, dans les commentaires d’articles et de tutoriels ainsi que dans les MP</li>
<li>external/external : utilisateur qui permet de récupérer les tutoriels d’anciens membres et/ou de publier des tutoriels externes.</li>
<li>ïtrema/ïtrema : utilisateur de test supplémentaire sans droit</li>
<li>decal/decal: un compte qui possède un identifiant <code class="docutils literal"><span class="pre">Profile</span></code> différent de l’identifiant <code class="docutils literal"><span class="pre">user</span></code> pour permettre de tester le cas où ces identifiants sont différents</li>
<li>dev/dev : utilisateur dans le groupe des développeurs</li>
</ul>
<p>Pour que ces membres soient ajoutés à la base de données, il est donc nécéssaire d’exécuter la commande suivante, à la racine du site :</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python manage.py loaddata fixtures/users.yaml
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Les utilisateurs <code class="docutils literal"><span class="pre">anonymous</span></code> et <code class="docutils literal"><span class="pre">external</span></code> <strong>doivent</strong> être présents dans la base de données pour le bon fonctionnement du site.
En effet, ils permettent le bon fonctionnement du processus d’anonymisation (voir <a class="reference external" href="#desinscription">plus haut</a>)</p>
</div>
<p>Les utilisateurs <code class="docutils literal"><span class="pre">anonymous</span></code> et <code class="docutils literal"><span class="pre">external</span></code> sont totalement paramétrables dans le fichier <code class="docutils literal"><span class="pre">zds/settings.py</span></code> :
pour changer le nom d’utilisateur (<em>username</em>) de ces comptes, agissez sur les constantes suivantes (du dictionnaire ZDS_APP):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Constant for anonymisation</span>

<span class="n">anonymous_account</span> <span class="o">=</span> <span class="s2">&quot;anonymous&quot;</span>
<span class="n">external_account</span> <span class="o">=</span> <span class="s2">&quot;external&quot;</span>
</pre></div>
</div>
<p>Bien entendu, les comptes correspondants doivent exister dans la base de données.</p>
<div class="section" id="l-interface-de-promotion">
<h3>L’interface de promotion<a class="headerlink" href="#l-interface-de-promotion" title="Permalink to this headline">¶</a></h3>
<p>Afin de pouvoir gérer les membres directement depuis le site (c’est-à-dire sans avoir besoin de passer par l’interface d’administration de Django), une interface de promotion a été développée. Elle est accessible aux membres ayant le statut de super-utilisateur via un lien présent sur tous les profils.
Cette interface permet :
1. D’ajouter/supprimer un membre dans un/des groupe(s)
2. De (dés)activer un compte</p>
<p>Le premier point permet notamment de passer un membre dans le groupe staff ou développeur. Si d’autres groupes venaient à voir le jour (validateur par exemple), alors il sera possible ici aussi de le changer.
Le second point concerne simplement l’activation du compte (normalement faite par le membre à l’inscription).</p>
<p>Elle est gérée par le formulaire <cite>PromoteMemberForm</cite> présent dans le fichier <cite>zds/member/forms.py</cite>.
Elle est ensuite visible via le template <cite>member/settings/promote.html</cite>.</p>
<p>Le profil de chaque membre contient également un lien vers l’administration de Django si l’utilisateur connecté y a accès et est super-utilisateur. Cela permet de nommer un membre super-utilisateur ou de lui donner l’accès à l’administration.</p>
</div>
<div class="section" id="les-casquettes">
<h3>Les casquettes<a class="headerlink" href="#les-casquettes" title="Permalink to this headline">¶</a></h3>
<p>Les casquettes sont un moyen de certifier qu’un utilisateur a un rôle particulier (comme membre du staff, développeur, etc). Les casquettes d’un membre sont listées sur son profil et il est également possible lors de l’envoi d’un message de le poster avec une casquette particulière, qui sera mise en avant sur le message.</p>
<p>Il est possible de modifier la casquette d’un message en l’éditant. Seules les casquettes possédées par le membre lors de l’édition peuvent être sélectionnés. Lorsqu’une casquette est retirée à un membre, les messages ayant été postés avec cette casquette la conservent. Cependant, il est obligatoire de modifier (ou de supprimer) la casquette d’un message s’il est édité alors que le membre ne la possède plus.</p>
<p>Les casquettes peuvent être demandées dans les paramètres de son compte. Les demandes sont vérifiées par les modérateurs ayant la permission <code class="docutils literal"><span class="pre">utils.change_hat</span></code> qui peuvent décider de les accepter ou de les refuser. Les membres ayant cette permission peuvent également ajouter une casquette sans passer par le système de demande.</p>
<p>Les membres peuvent supprimer eux-mêmes leurs casquettes. Les utilisateurs ayant la permission <code class="docutils literal"><span class="pre">utils.change_hat</span></code> peuvent supprimer les casquettes de tout le monde.</p>
<p>Attention : la casse est déterminée lors du premier ajout d’une casquette. Ainsi, si vous ajoutez une casquette « Staff » à un membre, ajouter une casquette « staff » à un autre membre par la suite lui ajoutera en réalité la casquette « Staff ». Si nécessaire, la casse d’une casquette peut être modifiée via l’administration de Django.</p>
<p>Il est également possible, depuis l’administration de Django, de lier une casquette à un groupe, ce qui l’accordera automatiquement à tous les membres du groupe. À noter que lier une casquette à un groupe empêche toute assignation individuelle de celle-ci à un membre. Ainsi, la dite casquette ne pourra plus être attribuée à un membre n’appartenant pas au groupe. De même, les membres du groupe ne pourront pas la supprimer sans quitter le groupe.</p>
<p>Les casquettes sont ajoutées aux MP automatiques en fonction des paramètres <code class="docutils literal"><span class="pre">ZDS_APP['hats']</span></code> renseignés dans le fichier <code class="docutils literal"><span class="pre">settings.py</span></code>.</p>
</div>
<div class="section" id="l-interface-de-karma">
<h3>L’interface de karma<a class="headerlink" href="#l-interface-de-karma" title="Permalink to this headline">¶</a></h3>
<p>Pour pouvoir communiquer entre modérateurs, il est utile d’avoir un outil de suivi sur les membres. Ce dernier prend forme via la gestion du “karma” d’un membre. Le karma est une valeur numérique pouvant aller de -100 à +100. Cette valeur peut-être modifiée via l’ajout de bonus/malus par les modérateurs. Chaque modification du karma doit s’accompagner d’un commentaire, mais un commentaire n’entraîne pas forcément une modification du karma (0 point de bonus/malus).</p>
<p>Cet outil à deux rôles. Permettre d’identifier les membres <em>perturbateurs</em> mais aussi les membres <em>moteurs</em> qui pourrait faire l’objet d’un article ou d’une mise en avant de leurs projets.</p>
<p>Pour modifier le karma d’un membre, il faut donc être modérateur sur le site. Sur le profil d’un membre apparaît alors un formulaire pour ajouter un bonus/malus et la liste des modifications précédentes montrant l’impact (+/-), le message, l’auteur du bonus/malus et la date d’effet de ce dernier.</p>
<p>Lorsqu’un membre change de pseudo, une note de karma (de 0 point) est automatiquement ajoutée à son profil en faisant mention de son ancien et de son nouveau pseudo (afin de garder une tracabilité pour les membres du staff).</p>
</div>
<div class="section" id="l-interface-de-reinitialisation-de-mot-de-passe">
<h3>L’interface de réinitialisation de mot de passe<a class="headerlink" href="#l-interface-de-reinitialisation-de-mot-de-passe" title="Permalink to this headline">¶</a></h3>
<p>Quand un membre du site oublie son mot de passe, il peut le réinitialiser. L’ancien mot de passe est supprimé et l’utilisateur peut en choisir un nouveau.
Pour cela, il se rend sur la page de réinitialisation de mot de passe (<code class="docutils literal"><span class="pre">membres/reinitialisation/</span></code>) à partir de la page de connexion.</p>
<blockquote>
<div><div class="figure">
<img alt="../_images/reinitialisation-mot-de-passe-1.png" src="../_images/reinitialisation-mot-de-passe-1.png" />
</div>
</div></blockquote>
<p>Sur cette page, l’utilisateur doit rentrer son pseudo ou l’adresse de courriel associée à son compte.
Quand l’utilisateur clique sur le bouton de validation, un jeton est généré aléatoirement et est stocké dans la base de données.</p>
<p>Un message est envoyé à l’adresse de courriel de l’utilisateur. Ce courriel contient un lien de réinitialisation. Ce lien contient en paramètre le jeton de réinitialisation et dirige l’utilisateur vers l’adresse <code class="docutils literal"><span class="pre">membres/new_password/</span></code>.</p>
<blockquote>
<div><div class="figure">
<img alt="../_images/reinitialisation-mot-de-passe-2.png" src="../_images/reinitialisation-mot-de-passe-2.png" />
</div>
</div></blockquote>
<p>Cette page permet de changer le mot de passe de l’utilisateur. L’utilisateur remplit le formulaire et clique sur le bouton de validation.
Si le mot de passe et le champ de confirmation correspondent et que le mot de passe respecte les règles métiers, le mot de passe est changé.
Le système affiche un message de confirmation du changement de mot de passe.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<ul class="last">
<li><p class="first">Il n’existe aucune restriction sur le nombre de demande de réinitialisation.</p>
</li>
<li><p class="first">Un utilisateur peut avoir le même nom d’utilisateur que l’adresse email de quelqu’un d’autre. Exemple:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">username</th>
<th class="head">email</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>firm1</td>
<td><a class="reference external" href="mailto:firm1&#37;&#52;&#48;gmail&#46;com">firm1<span>&#64;</span>gmail<span>&#46;</span>com</a></td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="mailto:firm1&#37;&#52;&#48;gmail&#46;com">firm1<span>&#64;</span>gmail<span>&#46;</span>com</a></td>
<td><a class="reference external" href="mailto:firm1&#37;&#52;&#48;zestedesavoir&#46;com">firm1<span>&#64;</span>zestedesavoir<span>&#46;</span>com</a></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
</ul>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<ul class="last simple">
<li>Le mot de passe doit faire au moins 6 caractères.</li>
<li>Le lien est valable une heure. Si l’utilisateur ne clique pas sur le lien dans le temps imparti, un message d’erreur est affiché.</li>
<li>Le jeton de réinitialisation de mot de passe n’est valide qu’une seule fois. Si l’utilisateur tente de changer son mot de passe avec le même jeton, une page 404 lui est affichée.</li>
</ul>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="private-message.html" class="btn btn-neutral float-right" title="Les messages privés" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gallery.html" class="btn btn-neutral" title="Les galeries" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, zestedesavoir.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>